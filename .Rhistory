nrow(df)
str(df)  # 10450
View(df)
table(df$media)
max(table(df$media))
names(max(table(df$media)))
name(max(table(df$media)))
rownames(max(table(df$media)))
index(max(table(df$media)))
names(df$media[(max(table(df$media))]))
names(df$media[(max(table(df$media))))
names(df$media)
max(df$media)
nrow(df$media[df$media == "PTT分享新聞",])
nrow(df[df$media == "PTT分享新聞",])
max(levels(table(df$media)))
max(table(df$media)))
max(table(df$media))
df$media[table(df$media) == 7385]
names(table(df$media)[max(table(df$media))]
names(table(df$media))[max(table(df$media))]
names(table(df$media))[0]
names(table(df$media))
names(table(df$media))[1]
names(table(df$media))[1][1]
df$media[table(df$media) == 7385]
max(table(df$media))
names(table(df$media))$count
match(names(df$media), as.character(max(table(df$media))))
match(names(df$media), max(table(df$media)))
names(df$media)
match(names(table(df$media)), max(table(df$media)))
match(names(table(df$media)), as.character(max(table(df$media))))
as.character(max(table(df$media)))
names(table(df$media))
values(table(df$media))
unname(table(df$media))
match(unname(table(df$media)), as.character(max(table(df$media))))
table(df$media)[match(unname(table(df$media)), as.character(max(table(df$media))))]
df$media[match(unname(table(df$media)), as.character(max(table(df$media))))]
match(unname(table(df$media)), as.character(max(table(df$media))))
table(df$media)
match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)
table(df$media)[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)]
table(df$media)
match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)
as.vector(table(df$media)[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)])
as.vector(table(df$media)
)
as.vector(table(df$media)[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
as.vector(table(df$media))[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
as.vector(table(df$media))[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))
as.vector(table(df$media))[match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)]
match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0)
as.vector(table(df$media))
as.vector(table(df$media))[0,0,1,0]
?grep
grep(1,match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))
as.vector(table(df$media))[grep(1,match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
table(df$media)[grep(1,match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
names(table(df$media))[grep(1,match(unname(table(df$media)), as.character(max(table(df$media))),nomatch = 0))]
str(df)
max(as.Date(df$date))
min(as.Date(df$date))
max(as.Date(df$date)) - min(as.Date(df$date))
table(as.Date(df$date))
max(table(as.Date(df$date)))
names(table(df$date))[grep(1,match(unname(table(df$date)),
as.character(max(table(df$date))),
nomatch = 0))]                        # "PTT分享新聞"
plot(table(df$date))
df1 = as.data.frame(table(df$date))
View(df1)
df1$highlight = 0
View(df1)
max_date = names(table(df$date))[grep(1,match(unname(table(df$date)),
as.character(max(table(df$date))),
nomatch = 0))]
max_date
View(df1)
df1$highlight[df1$Var1 == max_date] = 1
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( 1="tomato", 0="gray" ), guide = FALSE )
df1$highlight = "N"
df1$highlight[df1$Var1 == max_date] = "Y"
library(ggplot2)
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE )
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
geom_text(data = df_max,
aes(label = max, y = max), vjust = -.25)
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
geom_text(data = df1,
aes(label = max, y = max), vjust = -.25)
library(scales) # install.packages("scales")
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "weeks" , date_labels = "%b-%y")
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y")
df1$Var1 = as.Date(df1$Var1)
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y")
frollmean(df1$Var1)
library(data.table) # install.packages("data.table")
frollmean(df1$Var1)
frollmean(df1$Var1, 5)
frollmean(df1$Var1, 2)
df1$Var1
frollmean(df1$Freq, 5)
max(frollmean(df1$Freq, 5))
max(frollmean(df1$Freq, 5), na.rm = TRUE)
df1$Var1[max(frollmean(df1$Freq, 5), na.rm = TRUE)]
df1$Var1[df1$Var1 == max(frollmean(df1$Freq, 5), na.rm = TRUE)]
df1$Var1[df1$Freq == max(frollmean(df1$Freq, 5), na.rm = TRUE)]
View(df1)
View(df)
View(df1)
df1$mov_avg = frollmean(df1$Freq, 5), na.rm = TRUE
df1$mov_avg = frollmean(df1$Freq, 5)
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
geom_line(aes(y=rollmean(Color, 7, na.pad=TRUE)))
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
geom_line(aes(y=df1$mov_avg)
)
df1$date[df1$Freq == max(frollmean(df1$Freq, 5), na.rm = TRUE)]                 # "2020-01-25"
df1$date[df1$Freq == max(frollmean(df1$Freq, 5), na.rm = TRUE)]                 # "2020-01-25"
max(frollmean(df1$Freq, 5), na.rm = TRUE)
max(df1$mov_avg, na.rm = TRUE)
df1$Freq == max(df1$mov_avg, na.rm = TRUE)
df1$date[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]
View(df1)
df1$Var1[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
df1$mov_avg = frollmean(df1$Freq, 10)
df1$Var1[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
geom_line(aes(y=df1$mov_avg))
df1$Var1[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
df1$mov_avg = frollmean(df1$Freq, 10)
df1$Freq == max(df1$mov_avg, na.rm = TRUE)
max(df1$mov_avg, na.rm = TRUE)
df1$Freq
df1$mov_avg = as.integer(frollmean(df1$Freq, 10))
df1$Var1[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]
df1$mov_avg = as.integer(frollmean(df1$Freq, 10))
max(df1$mov_avg, na.rm = TRUE)
df1$mov_avg = round(frollmean(df1$Freq, 10), 0)
df1$Var1[df1$Freq == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
max(df1$mov_avg, na.rm = TRUE)
df1$Var1[df1$mov_avg == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
df1$Var1[df1$mov_avg == max(df1$mov_avg, na.rm = TRUE)]
df1$mov_avg = frollmean(df1$Freq, 10)
df1$Var1[df1$mov_avg == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
max(df1$mov_avg, na.rm = TRUE)
df1$mov_avg
max(df1$mov_avg, na.rm = TRUE)
df1$mov_avg == max(df1$mov_avg, na.rm = TRUE)
df1$mov_avg[is.na(df1$mov_avg)] = 0
df1$Var1[df1$mov_avg == max(df1$mov_avg, na.rm = TRUE)]                 # "2020-01-25"
ggplot( df1, aes( x = Var1, y = Freq, fill = highlight ) ) +
geom_bar( stat = "identity" ) +
scale_fill_manual( values = c( "Y"="tomato", "N"="gray" ), guide = FALSE ) +
scale_x_date(date_breaks = "months" , date_labels = "%b-%y") +
geom_line(aes(y=))
getwd()
